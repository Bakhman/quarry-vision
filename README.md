<p align="left">
  <!-- Java CI -->
  <a href="https://github.com/Bakhman/quarry-vision/actions/workflows/ci.yaml">
    <img src="https://github.com/Bakhman/quarry-vision/actions/workflows/ci.yaml/badge.svg?branch=main" alt="Java CI Status" />
  </a>
  <!-- Trello Sync -->
  <a href="https://github.com/Bakhman/quarry-vision/actions/workflows/trello-sync.yaml">
    <img src="https://github.com/Bakhman/quarry-vision/actions/workflows/trello-sync.yaml/badge.svg?branch=main" alt="Trello Sync" />
  </a>
</p>

# quarry-vision

Счётчик ковшей/рейсов для карьера + трекинг погрузки/разгрузки. Java 17, JavaFX, Maven, SnakeYAML, PostgreSQL.

[![Trello Sync](https://github.com/Bakhman/quarry-vision/actions/workflows/trello-sync.yaml/badge.svg?branch=main)](https://github.com/Bakhman/quarry-vision/actions/workflows/trello-sync.yaml)

![Build](https://github.com/Bakhman/quarry-vision/actions/workflows/ci.yml/badge.svg)

## Требования
- JDK 17 (Temurin)
- Maven 3.9+
- Windows (для запуска JavaFX профилем `win`; Linux/macOS возможны позже)

## Запуск
### Через Maven (рекомендовано)

mvn javafx:run

Нужно ПО, которое с двух камер(установленных в кабинах экскаваторов, которые
находятся на щебеночном карьере), считает ковши, время начала и окончания погрузки грузовиков, 
и считает количество рейсов грузовиков на щебеночный завод с одной камеры
(установленной на территории завода) на выгрузке. Также программа должна с одной 
камеры(установленной на территории завода) считать ковши на погрузке готовой продукции. - Минимальный интерфейс, бесплатные библиотеки, реализация на Java. Цель Разработать систему на Java с минимальным интерфейсом и использованием бесплатных библиотек, которая: 
1. Считает ковши с двух камер в кабинах экскаваторов, работающих на щебёночном карьере.
2. Фиксирует время начала и окончания погрузки каждого грузовика на карьере.
3. Считает количество рейсов грузовиков на завод с помощью одной камеры, установленной на территории завода в точке выгрузки.
4. Считает ковши при погрузке готовой продукции на заводе (другая камера на территории завода).
5. На погрузке в карьере а также на выгрузке и погрузке на заводе программа должна считывать номера загружаемых грузовиков и количество погрузок в каждый грузовик по отдельности. 

________________________________________
Техническое задание
Система автоматического учёта погрузки и выгрузки грузовиков на щебёночном карьере и заводе
Цель
Разработать систему на Java с минимальным интерфейсом и использованием бесплатных библиотек, которая выполняет:
1.	Подсчёт ковшей с двух камер в кабинах экскаваторов, работающих на щебёночном карьере.
2.	Фиксацию времени начала и окончания погрузки каждого грузовика.
3.	Подсчёт рейсов грузовиков на завод по одной камере, установленной на территории завода в точке выгрузки.
4.	Подсчёт ковшей при погрузке готовой продукции на заводе (другая камера на территории завода).
5.	Распознавание номеров грузовиков на погрузке (карьер) и при выгрузке/погрузке на заводе.
6.	Учёт количества ковшей для каждого грузовика отдельно по номеру.
________________________________________
Расположение камер
•	Камера 1 — кабина экскаватора №1 (погрузка щебня в кузов).
•	Камера 2 — кабина экскаватора №2 (погрузка щебня в кузов).
•	Камера 3 — завод, точка выгрузки (учёт рейсов).
•	Камера 4 — завод, погрузка готовой продукции (учёт ковшей и рейсов).
________________________________________
Функциональные модули
1.	Видео-захват и потоковая обработка
o	Используем OpenCV для работы с RTSP/HTTP потоками камер.
o	Обработка кадров в реальном времени.
2.	Подсчёт ковшей
o	Алгоритм детектирования ковша в кадре (например, на основе движения, изменения формы и области интереса).
o	Отдельный счётчик для каждого грузовика.
3.	Определение начала и конца погрузки
o	Состояния: ожидание → погрузка → завершение.
o	Логика фиксации времени в базу данных.
4.	Распознавание номеров
o	Используем Tess4J (Java-обёртка для Tesseract OCR) для извлечения номера с кадра.
o	Возможна дополнительная фильтрация с OpenALPR (если будет нужна точность выше).
5.	Учёт рейсов
o	Камера 3 фиксирует проезд грузовика и сверяет номер с базой.
o	Запись события рейса с меткой времени.
6.	Хранилище данных
o	PostgreSQL для хранения:
	▪︎ Список грузовиков (номер, дата первого появления).
	▪︎ Лог загрузок/выгрузок (номер, количество ковшей, время начала/окончания, камера).
7.	Минимальный интерфейс
o	JavaFX/простая веб-панель.
o	Просмотр статистики по каждому грузовику.
o	Экспорт отчётов (CSV/Excel).
________________________________________
Технологический стек
•	Java 17+
•	OpenCV — детекция движения и объектов.
•	Tess4J — OCR для номеров.
•	PostgreSQL — база данных.
•	JavaFX или минимальный веб-интерфейс (Spring Boot + Thymeleaf).
•	Maven — сборка проекта.
________________________________________

src/main/java/com/quarryvision
  ├─ app/        # Boot, Config
  ├─ core/       # db, importer, video, ...
  └─ ui/         # JavaFX контроллеры
src/main/resources/
  ├─ application.yaml
  └─ logback.xml

## Chat Handbook

Для удобной работы с проектом см. [Chat Handbook](docs/chat-handbook.md).
